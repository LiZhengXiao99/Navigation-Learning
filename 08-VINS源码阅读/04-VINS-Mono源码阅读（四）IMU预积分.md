[TOC]

## 一、IMU 预积分原理

> 内容主要摘自**邱笑晨**写的文档：**[IMU-Preintegration-Propogation-Doc](https://github.com/PetWorm/IMU-Preintegration-Propogation-Doc)**，本文所有的 IMU 都指捷联惯导，不考虑平台惯导。

IMU 预积分技术最早由 T Lupton 于 12 年提出，C Forster 于 15 年将其进一步拓展到李代数上，形成了一套优雅的理论体系。Forster 将 IMU 预积分在开源因子图优化库 GTSAM 中进行了实现，并完成了和其另一大作 SVO 的组合。这套理论目前已经被广泛的应用在基于 Bundle Adjustment 优化框架的 Visual Inertial Odometry 中。其中包括 VI-ORBSLAM，港科大 VINS，百度/浙大 ICE-BA 等。

![image-20230816132201403](https://pic-bed-1316053657.cos.ap-nanjing.myqcloud.com/img/image-20230816132201403.png)

如图，IMU 量测值频率远高于时间量测，假设了短时间内的积分项为常数，将第 $k$ 帧和第 $k+1$ 帧之间的所有 IMU 进行积分，通过迭代优化估计非积分项的状态值，可得第 $\mathrm{k}+1$ 帧的位置、速度和旋转 (PVQ)，作为视觉估计的初始值，避免了优化过程中的重复积分，主要是为了提高计算效率。具体原理如下：

**IMU**（Inertial measurement unit）惯性测量单元，包括**加速度计**和**角速度**。加速度计用于测量物体的加速度，陀螺仪可以测量物体的三轴角速度。

**惯性导航的核心原理**基于牛顿第二定律，即位置的导数等于速度，速度的导数等于加速度。如果我们假设参考坐标系下载体的初始速度和初始位置已知，利用载体运动过程中参考系下的加速度信息，就可以不断地进行积分运算，更新实时的速度和位置。但实际的情况与理想不同：

* 加速度是由与载体固连的加速度计测量得到的（会跟随载体转动），每一时刻的加速度都是在当前的载体系下得到的，进行速度和位置的积分，前提是把这些加速度都统一到同一个坐标系下。更新姿态的作用就在于此——通过实时更新姿态，我们可以求得当前载体系相对于参考系的姿态，从而将载体系下的加速度测量投影到参考系下。

* 由于加速度计的测量原理，它敏感到的“加速度”实际上不是纯加速度，而是包含了反向重力加速度、向心力等有害加速度的比力。

* 传感器总是存在噪声的，惯性导航这种积分运算，必然使得 IMU 器件中的测量噪声不断的累积，从而造成定位和姿态误差，尤其是低精度 IMU 会极快发散。

传统捷联惯导的递推算法，以**初始状态为基础**，利用 IMU 测量得到的比力和角速度信息进行**积分运算**，实时**更新载体的位姿**及速度等状态，根据这种思路，如果知道上一帧图像采样时刻载体的位姿和速度，则可以根据两帧之间的 IMU 测量（角速度和比力）递推得到当前帧的位姿和速度。

在基于 BA 的视觉惯性融合算法中，各个节点的载体状态都是有待优化的量。IMU 预积分的初衷，是希望**借鉴纯视觉 SLAM 中图优化的思想，将帧与帧之间 IMU 相对测量信息转换为约束节点（载体位姿）的边参与到优化框架中**。IMU 预积分理论最大的贡献是对这些 IMU 相对测量进行处理，使得它**与绝对位姿解耦**（或者只需要线性运算就可以进行校正），从而大大提高优化速度。































![image-20230817135807292](https://pic-bed-1316053657.cos.ap-nanjing.myqcloud.com/img/image-20230817135807292.png)

